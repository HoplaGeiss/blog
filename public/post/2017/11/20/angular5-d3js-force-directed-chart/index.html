
<!DOCTYPE html>
<html lang="en-gb">

    <head>

        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <meta property="og:title" content=" Angular 5 / d3.js - Force Directed Chart &middot;  Gabriel Muller - JavaScript and Angular articles" />
        <meta property="og:site_name" content="Gabriel Muller - JavaScript and Angular articles" />
        <meta property="og:url" content="http://www.muller.tech/post/2017/11/20/angular5-d3js-force-directed-chart/" />

    
        <meta property="og:type" content="article" />
        <meta property="og:article:published_time" content="2017-11-20T00:00:00Z" />
        <meta property="og:article:tag" content="angular5" />
        <meta property="og:article:tag" content="d3.js" />
        

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@" />
        <meta name="twitter:creator" content="@" />
        <meta name="twitter:title" content="Angular 5 / d3.js - Force Directed Chart" />
        <meta name="twitter:description" content="Create a force directed chart with angular5 and d3.js" />
        <meta name="twitter:url" content="http://www.muller.tech/post/2017/11/20/angular5-d3js-force-directed-chart/" />
    

        <title> Angular 5 / d3.js - Force Directed Chart &middot;  Gabriel Muller - JavaScript and Angular articles</title>

        <link rel="preload" href="/js/main.js" as="script" />
        <link rel="preload" href="/css/main.css" as="style" />

    
        <meta name="description" content="Create a force directed chart with angular5 and d3.js" />
    

    
        <meta name="p:domain_verify" content=""/>
    

        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        
        

    
        <link href="http://www.muller.tech/index.xml" rel="alternate" type="application/rss+xml" title="Gabriel Muller - JavaScript and Angular articles" />
    

    
        <link rel="canonical" href="http://www.muller.tech/post/2017/11/20/angular5-d3js-force-directed-chart/" />


    
    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "http://www.muller.tech/post/2017/11/20/angular5-d3js-force-directed-chart/"
        },
        "headline": "Angular 5 / d3.js - Force Directed Chart",
        "description": "Create a force directed chart with angular5 and d3.js",
        "author": {
            "@type": "Person",
            "name": "Gabriel Muller",
            "url": "http://profiles.google.com/?rel=author",
            "image": {
              "@type": "ImageObject",
              "url": "https:",
              "height": 80,
              "width": 80
            }
        },
        "publisher": {
          "@type": "Organization",
          "@id": "http://www.muller.tech/",
          "name": "Gabriel Muller - JavaScript and Angular articles",
          "url": "http://www.muller.tech/",
          "logo": {
            "@type": "ImageObject",
            "url": "https:",
            "height": 80,
            "width": 80
          }
        },
        "image": {
          "@type": "ImageObject",
          "url": "http://www.muller.tech/images/force-directed-chart.png",
          "height": 133,
          "width": 200
        },
        "datePublished": "2017-11-20",
        "dateModified": "2017-11-20",
        "wordCount": 1089,
        "keywords": ["angular5","d3.js"]
    }
    </script>


    
    <script type="text/javascript">
    
    
      var disqus_shortname = 'mullertech';
      var disqus_identifier = 'http:\/\/www.muller.tech\/post\/2017\/11\/20\/angular5-d3js-force-directed-chart\/';
      var disqus_title = 'Angular 5 \/ d3.js - Force Directed Chart';
      var disqus_url = 'http:\/\/www.muller.tech\/post\/2017\/11\/20\/angular5-d3js-force-directed-chart\/';
    
    </script>
    

    <style>
html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,figure,footer,header,main,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figure{margin:1em 40px}a{background-color:transparent;-webkit-text-decoration-skip:objects}img{border-style:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}@font-face{font-family:'Merriweather Sans';font-style:normal;font-weight:300;src:local("Merriweather Sans Light"),local(MerriweatherSans-Light),url(//fonts.gstatic.com/s/merriweathersans/v5/6LmGj5dOJopQKEkt88GowY_zIojJi0m4a5Z6tRh6itY.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:normal;font-weight:400;src:local("Merriweather Sans Regular"),local(MerriweatherSans-Regular),url(//fonts.gstatic.com/s/merriweathersans/v5/AKu1CjQ4qnV8MUltkAX3sL2aU247V0zTzydO4RoO9Ok.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:normal;font-weight:700;src:local("Merriweather Sans Bold"),local(MerriweatherSans-Bold),url(//fonts.gstatic.com/s/merriweathersans/v5/6LmGj5dOJopQKEkt88GowQfd-b-I5PxxcmB4_-MNcqw.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:normal;font-weight:800;src:local("Merriweather Sans ExtraBold"),local(MerriweatherSans-ExtraBold),url(//fonts.gstatic.com/s/merriweathersans/v5/6LmGj5dOJopQKEkt88GowWT7sFQ1Iz1BbpcuCPlgc9Q.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:italic;font-weight:300;src:local("Merriweather Sans Light Italic"),local(MerriweatherSans-LightItalic),url(//fonts.gstatic.com/s/merriweathersans/v5/nAqt4hiqwq3tzCecpgPmVX9UU5BmOJGkLxUCVv5VXdc.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:italic;font-weight:400;src:local("Merriweather Sans Italic"),local(MerriweatherSans-Italic),url(//fonts.gstatic.com/s/merriweathersans/v5/3Mz4hOHzs2npRMG3B1ascf0KIgDhPIHb_R-SWdtqte8.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:italic;font-weight:700;src:local("Merriweather Sans Bold Italic"),local(MerriweatherSans-BoldItalic),url(//fonts.gstatic.com/s/merriweathersans/v5/nAqt4hiqwq3tzCecpgPmVYM8pfYvjMoOxygpzLVILAs.woff) format("woff")}@font-face{font-family:'icons';src:url(/fonts/icons.eot?9273991);src:url(/fonts/icons.eot?9273991#iefix) format("embedded-opentype"),url(/fonts/icons.woff?9273991) format("woff"),url(/fonts/icons.ttf?9273991) format("truetype"),url(/fonts/icons.svg?9273991#icons) format("svg");font-weight:400;font-style:normal}[class^="icon-"]:before{font-family:"icons";font-style:normal;font-weight:400;speak:none;display:inline-block;text-decoration:inherit;width:1em;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-arrow-right:before{content:'\e807'}.icon-rss:before{content:'\e808'}body{font:300 1em / 1.5em 'Merriweather Sans',sans-serif;color:#595B66}a{color:inherit;text-decoration:none;font-weight:400}h1,h2{text-rendering:optimizeLegibility;color:#1F2026}h2 a{font-weight:inherit}h1{font-size:2em;line-height:1em;margin:2em 0 -.5em}h2{font-size:1.75em;line-height:1.143em;margin:2.286em 0 -.571em}p{margin:2em auto}i{font-weight:400;font-style:italic;color:#363740}img{display:block;max-width:100%;height:auto;margin:2.5em auto}body{background:#fff}.inner{max-width:48em;margin:0 auto;padding:0 1em}#wrapper{position:relative;box-sizing:border-box;width:100%;min-height:100vh;padding-bottom:6em;background:#F2F3F5}#push{transform:translate3d(0,0,0);transform-style:preserve-3d;opacity:1}#nav{position:relative;background:#fff;z-index:70;transform:translate3d(0,0,0);transform-style:preserve-3d;opacity:1}#nav:after{clear:both;content:'';display:table}#nav .nav-logo{float:left;height:2em;padding:1em;max-width:50%}#nav .nav-logo img{width:auto;max-width:none;height:2em;margin:0;border-radius:5px}#nav .nav-menu{float:right}#nav .nav-menu:after{clear:both;content:'';display:table}#nav .nav-menu a{display:block;width:1em;height:1em;line-height:1em;padding:1.5em;text-align:center;float:left}#nav .nav-menu a i:before{margin:auto}.overlay{display:none;position:fixed;left:0;top:0;width:100%;height:100%;z-index:80;display:none}.overlay:before{content:'';position:absolute;left:0;top:0;width:100%;height:100%;background:#1F2026;opacity:0;transform-style:preserve-3d}#header{position:relative;padding:4em 0}#header .inner{position:relative;z-index:2}#header .header-title{display:block;text-align:center}#header .header-name{font-weight:700;letter-spacing:-1px;display:block;line-height:1em;font-size:2em;text-decoration:none;color:#1F2026;padding:0;margin:0}#header.has-cover .header-name{color:#fff}#header .header-description{display:block;margin:1em auto 0;color:#9D9FA6;position:relative;font-weight:300}#header .header-description:after{content:'';position:absolute;height:1px;width:100px;margin-left:-50px;left:50%;top:-.5em;background:#D4D5D9}#header.has-cover .header-description{color:#fff}#header.has-cover .header-description:after{background:#fff}#header .header-cover{position:absolute;width:100%;height:100%;top:0;left:0;margin-top:-4em;padding:4em 0;background:no-repeat fixed center 100% / cover;z-index:1}#header .header-cover:before{content:'';position:absolute;width:100%;height:100%;left:0;top:0;background:rgba(0,0,0,0.2)}#header .header-cover:after{content:'';position:absolute;width:100%;left:0;bottom:0;border-bottom:4px solid #36D995}#footer{position:absolute;width:100%;left:0;bottom:0;font-size:.75em;line-height:1.334em;background:#1F2026;color:#737580;z-index:20;transform:translate3d(0,0,0);transform-style:preserve-3d;opacity:1}#footer a{color:#9D9FA6;font-weight:400}#footer .credits{text-align:center;font-size:.75em;line-height:1.334em;padding:2.667em;overflow:auto}#footer .credits span{display:block}#footer .credits .credits-theme{float:left}#footer .credits .credits-software{float:right}.post{position:relative;z-index:20}.post .post-image{display:block;margin:0;padding:0}.post .post-image img{display:block;width:100%;height:auto;margin:0;padding:0}.post .post-meta{display:block;font-size:.75em;line-height:1.334em;font-weight:400;margin-bottom:1.334em}.post .post-title{position:relative;color:#000;font-size:2em;line-height:1.375em;font-weight:800;text-indent:-1px;margin:.25em 0 .75em}.post .post-title:before{content:'';position:absolute;left:0;bottom:-.334em;width:1em;margin-bottom:-2px;border-bottom:4px solid #36D995}.post .post-title a{text-decoration:none;color:inherit;font-weight:inherit}#post-index{position:relative;max-width:1200px;margin:0 auto 4em;padding:.5em;z-index:10}@keyframes fade{0%{transform:translate3d(0,3em,0);opacity:0}100%{transform:translate3d(0,0,0);opacity:1}}.post-list{position:relative}.post-list .post{float:left;width:33.3%;transform:translate3d(0,3em,0);transform-style:preserve-3d;opacity:0;animation:fade ease-out .5s forwards;animation-delay:1.4s}@media only screen and (max-width: 50em){.post-list .post{width:49.9%}}@media only screen and (max-width: 30em){.post-list .post{width:100%;float:none}}.post-list .post:nth-child(1){animation-delay:.1s}.post-list .post:nth-child(2){animation-delay:.2s}.post-list .post:nth-child(3){animation-delay:.3s}.post-list .post:nth-child(4){animation-delay:.4s}.post-list .post:nth-child(5){animation-delay:.5s}.post-list .post:nth-child(6){animation-delay:.6s}.post-list .post:nth-child(7){animation-delay:.7s}.post-list .post:nth-child(8){animation-delay:.8s}.post-list .post:nth-child(9){animation-delay:.9s}.post-list .post .inner{padding:2em;margin:.5em;max-width:none;background:#fff;box-sizing:border-box;transform:scale(1);transform-style:preserve-3d}@media only screen and (max-width: 50em){.post-list .post .inner{padding:1em}}.post-list .post .post-link{position:absolute;left:0;top:0;width:100%;height:100%;z-index:10}.post-list .post .post-image{position:relative;margin:-2em -2em 0;overflow:hidden;background:#36D995}@media only screen and (max-width: 50em){.post-list .post .post-image{margin:-1em -1em 0}}.post-list .post .post-image img{transform:scale(1);transform-style:preserve-3d;opacity:1}.post-list .post .post-image:after{content:'';position:absolute;left:-5%;bottom:-2.5em;width:110%;height:4em;background:#fff;border-top:4px solid #36D995;box-shadow:0 0 2em rgba(0,0,0,0.2);transform:rotate(5deg)}.post-list .post .post-title{font-size:1.5em;line-height:1.167em}.post-list .post .post-excerpt{margin:0}.post-list .post .post-more{display:block;margin-top:1.5em}.post-list .post .post-more a{display:inline-block;font-size:.875em;line-height:1.143em;font-weight:400;color:#363740}.post-list .post .post-more a i{color:#2DB77E}.pagination{min-height:3em;margin:4em auto 2em;padding:0;position:relative}.pagination .pagination-item{position:relative;display:block;height:3em;line-height:3em;padding:0 1em;text-align:center;text-decoration:none;font-weight:700;color:#363740;border:1px solid #36D995;border-radius:4em;z-index:60}.pagination .pagination-item i{position:relative}@media only screen and (max-width: 30em){.pagination .pagination-item{width:4em;height:4em;line-height:4em;margin-top:-.5em;padding:0!important}.pagination .pagination-item i{font-size:1.5em}.pagination .pagination-item>span{display:none}}.pagination .pagination-prev{float:right}.pagination .pagination-prev i{right:-.05em}.pagination .pagination-info{display:block;left:0;top:0;height:3em;line-height:3em;position:absolute;text-align:center;width:100%;z-index:50;color:#9D9FA6}#loader-wrapper{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1000}#loader{display:block;position:relative;left:50%;top:50%;width:150px;height:150px;margin:-75px 0 0 -75px;border-radius:50%;border:3px solid transparent;border-top-color:#36D995;animation:spin 2s linear infinite}#loader:before{content:"";position:absolute;top:5px;left:5px;right:5px;bottom:5px;border-radius:50%;border:3px solid transparent;border-top-color:#2DB77E;animation:spin 3s linear infinite}#loader:after{content:"";position:absolute;top:15px;left:15px;right:15px;bottom:15px;border-radius:50%;border:3px solid transparent;border-top-color:#D4D5D9;animation:spin 1.5s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
</style>


    </head>
    <body class="home-template">
      <div id="loader-wrapper">
        <div id="loader"></div>
      </div>
      <section id="wrapper" style="display: none;">
        <div id="ajax-container">
          <nav id="nav" class="nav">
            <div class="nav-logo">
              <a href="http://www.muller.tech/">
      			  
      			  	<img src="/images/logo.png" alt="Logo"/>
      			  
              </a>
            </div>
            
          </nav>


<main class="content" role="main">
	<article class="post">
		<div class="inner">

			<div id="push">

  			<header class="post-header">
  				<span class="post-meta">
						<span class="post-date">20 Nov 2017</span> <span class="reading-time">| <span class="estimated-reading-time">6 min.</span> (<span class="word-count">1089</span> words)</span></span>
  				</span>
  				<div class="clear"></div>
  				<h1 class="post-title">Angular 5 / d3.js - Force Directed Chart</h1>
  			</header>

  			<section class="post-content">
  				

<p>In this post you will learn how to create a dynamic and resizeable force directed chart with angular5 and d3.js.</p>

<p>Take a look at the demo:
<a href="http://www.muller.tech/hopla-force-directed-chart/">http://www.muller.tech/hopla-force-directed-chart/</a></p>

<p>If you are in a hurry, you can checkout the source code here: <a href="https://github.com/HoplaGeiss/hopla-force-directed-chart">https://github.com/HoplaGeiss/hopla-force-directed-chart</a></p>

<p>Now, let&rsquo;s dive in!</p>

<h3 id="component-skeleton">Component skeleton</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#a90d91">import</span> { <span style="color:#000">Component</span>, <span style="color:#000">OnInit</span>, <span style="color:#000">OnChanges</span>, <span style="color:#000">ViewChild</span>, <span style="color:#000">ElementRef</span>, <span style="color:#000">Input</span>, <span style="color:#000">AfterViewChecked</span> } <span style="color:#000">from</span> <span style="color:#c41a16">&#39;@angular/core&#39;</span>;
<span style="color:#a90d91">import</span> <span style="color:#000">*</span> <span style="color:#a90d91">as</span> <span style="color:#000">d3</span> <span style="color:#000">from</span> <span style="color:#c41a16">&#39;d3&#39;</span>;
<span style="color:#a90d91">import</span> <span style="color:#000">*</span> <span style="color:#a90d91">as</span> <span style="color:#000">_</span> <span style="color:#000">from</span> <span style="color:#c41a16">&#39;underscore&#39;</span>;

<span style="color:#a90d91">@Component</span>({
  <span style="color:#000">selector</span><span style="color:#000">:</span> <span style="color:#c41a16">&#39;app-force-directed-chart&#39;</span>,
  <span style="color:#000">styleUrls</span><span style="color:#000">:</span> [<span style="color:#c41a16">&#39;./force-directed-chart.component.scss&#39;</span>],
  <span style="color:#000">template</span><span style="color:#000">:</span> <span style="color:#c41a16">`
</span><span style="color:#c41a16">    &lt;div class=&#39;force-directed-chart&#39; #forceDirectedChartContainer&gt;
</span><span style="color:#c41a16">      &lt;div class=&#39;tooltip&#39;&gt;
</span><span style="color:#c41a16">        &lt;div fxLayout=&#39;row&#39; fxLayoutAlign=&#39;start center&#39; class=&#39;header&#39;&gt;
</span><span style="color:#c41a16">          &lt;img src=&#39;assets/Icon-Sensors.svg&#39; alt=&#39;Sensors Icon&#39;&gt;
</span><span style="color:#c41a16">          &lt;div fxLayout=&#39;column&#39; fxLayoutAlign=&#39;center start&#39;&gt;
</span><span style="color:#c41a16">            &lt;div class=&#39;title&#39;&gt;{{node?.vendor}}&lt;/div&gt;
</span><span style="color:#c41a16">            &lt;div&gt;{{node?.model}}&lt;/div&gt;
</span><span style="color:#c41a16">          &lt;/div&gt;
</span><span style="color:#c41a16">        &lt;/div&gt;
</span><span style="color:#c41a16">        &lt;div fxLayout=&#39;column&#39; fxLayoutAlign=&#39;center start&#39; class=&#39;body&#39;&gt;
</span><span style="color:#c41a16">          &lt;div class=&#39;subtitle&#39;&gt;Name&lt;/div&gt;
</span><span style="color:#c41a16">          &lt;div&gt;{{node?.name}}&lt;/div&gt;
</span><span style="color:#c41a16">          &lt;div class=&#39;subtitle&#39;&gt;IP&lt;/div&gt;
</span><span style="color:#c41a16">          &lt;div&gt;{{node?.address}}&lt;/div&gt;
</span><span style="color:#c41a16">          &lt;div class=&#39;subtitle&#39;&gt;Protocol&lt;/div&gt;
</span><span style="color:#c41a16">          &lt;div&gt;{{node?.protocol}}&lt;/div&gt;
</span><span style="color:#c41a16">        &lt;/div&gt;
</span><span style="color:#c41a16">      &lt;/div&gt;
</span><span style="color:#c41a16">    &lt;/div&gt;
</span><span style="color:#c41a16">  `</span>
})

<span style="color:#a90d91">export</span> <span style="color:#a90d91">class</span> <span style="color:#000">ForceDirectedChartComponent</span> <span style="color:#a90d91">implements</span> <span style="color:#000">OnInit</span>, <span style="color:#000">OnChanges</span>, <span style="color:#000">AfterViewChecked</span> {
  <span style="color:#a90d91">@ViewChild</span>(<span style="color:#c41a16">&#39;forceDirectedChartContainer&#39;</span>) <span style="color:#a90d91">private</span> <span style="color:#000">chartContainer</span>: <span style="color:#a90d91">ElementRef</span>;
  <span style="color:#a90d91">@Input</span>() <span style="color:#000">data</span>: <span style="color:#a90d91">Array</span><span style="color:#000">&lt;</span><span style="color:#000">any</span><span style="color:#000">&gt;</span>;

  <span style="color:#000">node</span>: <span style="color:#a90d91">any</span>;

  <span style="color:#000">hostElement</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">tooltip</span>: <span style="color:#a90d91">any</span>;

  <span style="color:#000">linkElements</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">linkGroup</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">nodeElements</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">nodeGroup</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">imageGroup</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">textElements</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">textGroup</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">imageElements</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">links</span>: <span style="color:#a90d91">any</span>;

  <span style="color:#000">margin</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">width</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">height</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">hostElementHeight</span>: <span style="color:#a90d91">number</span>;

  <span style="color:#000">color</span>: <span style="color:#a90d91">any</span>;

  <span style="color:#000">svg</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">simulation</span>: <span style="color:#a90d91">any</span>;
  <span style="color:#000">sensors</span>: <span style="color:#a90d91">any</span>;

  <span style="color:#000">smallCircleRadius</span> <span style="color:#000">=</span> <span style="color:#1c01ce">6</span>;
  <span style="color:#000">largeCircleRadius</span> <span style="color:#000">=</span> <span style="color:#1c01ce">50</span>;

  <span style="color:#000">status</span>: <span style="color:#a90d91">string</span>;

  <span style="color:#a90d91">constructor</span>(
    <span style="color:#a90d91">private</span> <span style="color:#000">elementRef</span>: <span style="color:#a90d91">ElementRef</span>
  ) {}
}</code></pre></div>
<p>Not so much going on here. In the template we define the containers for the svg and for the tooltip. In the component itself we just define loads and loads of variables.</p>

<h3 id="life-cycle-methods">Life cycle methods</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#000">ngOnInit() {</span>
  <span style="color:#a90d91">this</span>.<span style="color:#000">hostElement</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">chartContainer</span>.<span style="color:#000">nativeElement</span>;
}

<span style="color:#000">ngOnChanges() {</span>
  <span style="color:#a90d91">if</span> (<span style="color:#a90d91">this</span>.<span style="color:#000">data</span>.<span style="color:#000">length</span> <span style="color:#000">&gt;</span> <span style="color:#1c01ce">0</span> <span style="color:#000">&amp;&amp;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">svg</span>) {
    <span style="color:#a90d91">this</span>.<span style="color:#000">sensors</span> <span style="color:#000">=</span> <span style="color:#000">_</span>.<span style="color:#000">sortBy</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">data</span>, <span style="color:#c41a16">&#39;familyType&#39;</span>);
    <span style="color:#a90d91">this</span>.<span style="color:#000">runSimulation</span>();
  }
}

() {
  <span style="color:#a90d91">if</span> (<span style="color:#a90d91">this</span>.<span style="color:#000">hostElement</span> <span style="color:#000">&amp;&amp;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">hostElement</span>.<span style="color:#000">offsetHeight</span> <span style="color:#000">!==</span> <span style="color:#1c01ce">0</span> <span style="color:#000">&amp;&amp;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">hostElement</span>.<span style="color:#000">offsetHeight</span> <span style="color:#000">!==</span> <span style="color:#a90d91">this</span>.<span style="color:#000">hostElementHeight</span>) {
    <span style="color:#a90d91">this</span>.<span style="color:#000">hostElementHeight</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">hostElement</span>.<span style="color:#000">offsetHeight</span>;
    <span style="color:#000">d3</span>.<span style="color:#000">select</span>(<span style="color:#c41a16">&#39;.svg&#39;</span>).<span style="color:#000">remove</span>();
    <span style="color:#a90d91">this</span>.<span style="color:#000">createChart</span>();
    <span style="color:#a90d91">if</span> (<span style="color:#a90d91">this</span>.<span style="color:#000">data</span>.<span style="color:#000">length</span> <span style="color:#000">&gt;</span> <span style="color:#1c01ce">0</span>) {
      <span style="color:#a90d91">this</span>.<span style="color:#000">sensors</span> <span style="color:#000">=</span> <span style="color:#000">_</span>.<span style="color:#000">sortBy</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">data</span>, <span style="color:#c41a16">&#39;familyType&#39;</span>);
      <span style="color:#a90d91">this</span>.<span style="color:#000">runSimulation</span>();
    }
  }
}</code></pre></div>
<p>Let&rsquo;s go through this life cycle methods one by one.</p>

<ul>
<li>ngOnInit: we just define the <code>hostElement</code> variable.</li>
<li>ngOnChanges: we update the chart with when new nata comes in.</li>
<li>ngAfterViewChecked: If the screen is resized, we delete the previous svg and create a new one.</li>
</ul>

<h3 id="create-the-chart">Create the chart</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#000">createChart</span> <span style="color:#000">=</span> () <span style="color:#000">=&gt;</span> {
  <span style="color:#177500">// Width &amp; height
</span><span style="color:#177500"></span>  <span style="color:#a90d91">this</span>.<span style="color:#000">margin</span> <span style="color:#000">=</span> { <span style="color:#000">top</span>: <span style="color:#a90d91">0</span>, <span style="color:#000">right</span>: <span style="color:#a90d91">0</span>, <span style="color:#000">bottom</span>: <span style="color:#a90d91">0</span>, <span style="color:#000">left</span>: <span style="color:#a90d91">0</span>};

  <span style="color:#a90d91">this</span>.<span style="color:#000">width</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">hostElement</span>.<span style="color:#000">offsetWidth</span> <span style="color:#000">-</span> <span style="color:#a90d91">this</span>.<span style="color:#000">margin</span>.<span style="color:#000">left</span> <span style="color:#000">-</span> <span style="color:#a90d91">this</span>.<span style="color:#000">margin</span>.<span style="color:#000">right</span>;
  <span style="color:#a90d91">this</span>.<span style="color:#000">height</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">hostElement</span>.<span style="color:#000">offsetHeight</span> <span style="color:#000">-</span> <span style="color:#a90d91">this</span>.<span style="color:#000">margin</span>.<span style="color:#000">top</span> <span style="color:#000">-</span> <span style="color:#a90d91">this</span>.<span style="color:#000">margin</span>.<span style="color:#000">bottom</span>;

  <span style="color:#177500">// Color
</span><span style="color:#177500"></span>  <span style="color:#a90d91">this</span>.<span style="color:#000">color</span> <span style="color:#000">=</span> <span style="color:#000">d3</span>.<span style="color:#000">scaleOrdinal</span>(<span style="color:#000">d3</span>.<span style="color:#000">schemeCategory20</span>);

  <span style="color:#a90d91">this</span>.<span style="color:#000">svg</span> <span style="color:#000">=</span> <span style="color:#000">d3</span>.<span style="color:#000">select</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">hostElement</span>)
    .<span style="color:#000">append</span>(<span style="color:#c41a16">&#39;svg&#39;</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;width&#39;</span>, <span style="color:#a90d91">this</span>.<span style="color:#000">hostElement</span>.<span style="color:#000">offsetWidth</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;height&#39;</span>, <span style="color:#a90d91">this</span>.<span style="color:#000">hostElement</span>.<span style="color:#000">offsetHeight</span>)
    .<span style="color:#000">append</span>(<span style="color:#c41a16">&#39;g&#39;</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;transform&#39;</span>, <span style="color:#c41a16">&#39;translate(&#39;</span> <span style="color:#000">+</span> <span style="color:#a90d91">this</span>.<span style="color:#000">margin</span>.<span style="color:#000">left</span> <span style="color:#000">+</span> <span style="color:#c41a16">&#39;,&#39;</span> <span style="color:#000">+</span> <span style="color:#a90d91">this</span>.<span style="color:#000">margin</span>.<span style="color:#000">top</span> <span style="color:#000">+</span> <span style="color:#c41a16">&#39;)&#39;</span>);

  <span style="color:#a90d91">this</span>.<span style="color:#000">linkGroup</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">svg</span>.<span style="color:#000">append</span>(<span style="color:#c41a16">&#39;g&#39;</span>).<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;class&#39;</span>, <span style="color:#c41a16">&#39;links&#39;</span>);
  <span style="color:#a90d91">this</span>.<span style="color:#000">nodeGroup</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">svg</span>.<span style="color:#000">append</span>(<span style="color:#c41a16">&#39;g&#39;</span>).<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;class&#39;</span>, <span style="color:#c41a16">&#39;nodes&#39;</span>);
  <span style="color:#a90d91">this</span>.<span style="color:#000">textGroup</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">svg</span>.<span style="color:#000">append</span>(<span style="color:#c41a16">&#39;g&#39;</span>).<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;class&#39;</span>, <span style="color:#c41a16">&#39;labels&#39;</span>);
  <span style="color:#a90d91">this</span>.<span style="color:#000">imageGroup</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">svg</span>.<span style="color:#000">append</span>(<span style="color:#c41a16">&#39;g&#39;</span>).<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;class&#39;</span>, <span style="color:#c41a16">&#39;images&#39;</span>);

  <span style="color:#a90d91">this</span>.<span style="color:#000">tooltip</span> <span style="color:#000">=</span>  <span style="color:#a90d91">this</span>.<span style="color:#000">elementRef</span>.<span style="color:#000">nativeElement</span>.<span style="color:#000">querySelector</span>(<span style="color:#c41a16">&#39;.tooltip&#39;</span>);
}</code></pre></div>
<p>This method creates the svg and instantiates the different groups and the tooltip.</p>

<h3 id="run-the-simulation">Run the simulation</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#000">runSimulation</span> <span style="color:#000">=</span> () <span style="color:#000">=&gt;</span> {
  <span style="color:#a90d91">this</span>.<span style="color:#000">simulation</span> <span style="color:#000">=</span> <span style="color:#000">d3</span>.<span style="color:#000">forceSimulation</span>()
    .<span style="color:#000">force</span>(<span style="color:#c41a16">&#39;link&#39;</span>, <span style="color:#000">d3</span>.<span style="color:#000">forceLink</span>().<span style="color:#000">id</span>((<span style="color:#000">node</span>: <span style="color:#a90d91">any</span>) <span style="color:#000">=&gt;</span> <span style="color:#000">node</span>.<span style="color:#000">id</span>).<span style="color:#000">distance</span>(<span style="color:#1c01ce">30</span>))
    .<span style="color:#000">force</span>(<span style="color:#c41a16">&#39;collide&#39;</span>, <span style="color:#000">d3</span>.<span style="color:#000">forceCollide</span><span style="color:#000">&lt;</span><span style="color:#000">any</span><span style="color:#000">&gt;</span>( <span style="color:#000">d</span> <span style="color:#000">=&gt;</span> <span style="color:#000">d</span>.<span style="color:#000">r</span> <span style="color:#000">+</span> <span style="color:#1c01ce">8</span> ).<span style="color:#000">iterations</span>(<span style="color:#1c01ce">16</span>))
    .<span style="color:#000">force</span>(<span style="color:#c41a16">&#39;charge&#39;</span>, <span style="color:#000">d3</span>.<span style="color:#000">forceManyBody</span>()
      .<span style="color:#000">strength</span>(<span style="color:#000">-</span><span style="color:#1c01ce">100</span>)
      .<span style="color:#000">distanceMax</span>(<span style="color:#1c01ce">200</span>)
      .<span style="color:#000">distanceMin</span>(<span style="color:#1c01ce">60</span>)
    )
    .<span style="color:#000">force</span>(<span style="color:#c41a16">&#39;center&#39;</span>, <span style="color:#000">d3</span>.<span style="color:#000">forceCenter</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">width</span> <span style="color:#c41a16">/ 2, this.height /</span> <span style="color:#1c01ce">2</span>));

  <span style="color:#a90d91">this</span>.<span style="color:#000">render</span>();

  <span style="color:#a90d91">this</span>.<span style="color:#000">simulation</span>.<span style="color:#000">nodes</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">sensors</span>).<span style="color:#000">on</span>(<span style="color:#c41a16">&#39;tick&#39;</span>, () <span style="color:#000">=&gt;</span> {
    <span style="color:#a90d91">this</span>.<span style="color:#000">nodeElements</span>
      .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;cx&#39;</span>, <span style="color:#000">node</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">placeElementX</span>(<span style="color:#000">node</span>) )
      .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;cy&#39;</span>, <span style="color:#000">node</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">placeElementY</span>(<span style="color:#000">node</span>))
      .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;fill&#39;</span>, <span style="color:#000">node</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">color</span>(<span style="color:#000">node</span>.<span style="color:#000">familyType</span>));

    <span style="color:#a90d91">this</span>.<span style="color:#000">linkElements</span>
      .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;x1&#39;</span>, <span style="color:#000">node</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">placeElementX</span>(<span style="color:#000">node</span>.<span style="color:#000">source</span>))
      .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;y1&#39;</span>, <span style="color:#000">node</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">placeElementY</span>(<span style="color:#000">node</span>.<span style="color:#000">source</span>))
      .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;x2&#39;</span>, <span style="color:#000">node</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">placeElementX</span>(<span style="color:#000">node</span>.<span style="color:#000">target</span>))
      .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;y2&#39;</span>, <span style="color:#000">node</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">placeElementY</span>(<span style="color:#000">node</span>.<span style="color:#000">target</span>));

    <span style="color:#a90d91">this</span>.<span style="color:#000">textElements</span>
      .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;x&#39;</span>, <span style="color:#000">groups</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">placeElementX</span>(<span style="color:#000">groups</span>[<span style="color:#000">groups</span>.<span style="color:#000">length</span> <span style="color:#000">-</span> <span style="color:#1c01ce">1</span>]))
      .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;y&#39;</span>, <span style="color:#000">groups</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">placeElementY</span>(<span style="color:#000">groups</span>[<span style="color:#000">groups</span>.<span style="color:#000">length</span> <span style="color:#000">-</span> <span style="color:#1c01ce">1</span>]))
      .<span style="color:#000">text</span>(<span style="color:#000">groups</span> <span style="color:#000">=&gt;</span> <span style="color:#000">groups</span>[<span style="color:#1c01ce">0</span>].<span style="color:#000">familyType</span>);
  });

  <span style="color:#a90d91">this</span>.<span style="color:#000">simulation</span>.<span style="color:#000">force</span>(<span style="color:#c41a16">&#39;link&#39;</span>).<span style="color:#000">links</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">links</span>);
}</code></pre></div>
<p>The simulation defines all sorts of physic parameters like how strongly the node are attracted or repulsed from each other, the minimum and maximum distance between nodes and so on.</p>

<p>On tick, we define the new location of the node. To do this we are using <code>placeElementX</code> and <code>placeElementY</code> because we want to keep the node within our container.</p>

<h3 id="render">Render</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#000">render</span> <span style="color:#000">=</span> () <span style="color:#000">=&gt;</span> {
  <span style="color:#a90d91">this</span>.<span style="color:#000">links</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">createLinks</span>();

  <span style="color:#a90d91">this</span>.<span style="color:#000">linkElements</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">linkGroup</span>.<span style="color:#000">selectAll</span>(<span style="color:#c41a16">&#39;line&#39;</span>)
    .<span style="color:#000">data</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">links</span>, <span style="color:#000">link</span> <span style="color:#000">=&gt;</span> <span style="color:#000">link</span>.<span style="color:#000">target</span>.<span style="color:#000">id</span> <span style="color:#000">+</span> <span style="color:#000">link</span>.<span style="color:#000">source</span>.<span style="color:#000">id</span>);

  <span style="color:#a90d91">this</span>.<span style="color:#000">linkElements</span>.<span style="color:#000">exit</span>().<span style="color:#000">remove</span>();

  <span style="color:#a90d91">const</span> <span style="color:#000">linkEnter</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">linkElements</span>
    .<span style="color:#000">enter</span>().<span style="color:#000">append</span>(<span style="color:#c41a16">&#39;line&#39;</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;stroke-width&#39;</span>, <span style="color:#1c01ce">1</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;stroke&#39;</span>, <span style="color:#c41a16">&#39;#d2d7d3&#39;</span>);

  <span style="color:#a90d91">this</span>.<span style="color:#000">linkElements</span> <span style="color:#000">=</span> <span style="color:#000">linkEnter</span>.<span style="color:#000">merge</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">linkElements</span>);

	<span style="color:#177500">// nodes
</span><span style="color:#177500"></span>  <span style="color:#a90d91">this</span>.<span style="color:#000">nodeElements</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">nodeGroup</span>.<span style="color:#000">selectAll</span>(<span style="color:#c41a16">&#39;circle&#39;</span>)
    .<span style="color:#000">data</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">sensors</span>, <span style="color:#000">node</span> <span style="color:#000">=&gt;</span> <span style="color:#000">node</span>.<span style="color:#000">id</span>);

  <span style="color:#a90d91">this</span>.<span style="color:#000">nodeElements</span>.<span style="color:#000">exit</span>().<span style="color:#000">remove</span>();

  <span style="color:#a90d91">const</span> <span style="color:#000">nodeEnter</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">nodeElements</span>
    .<span style="color:#000">enter</span>()
    .<span style="color:#000">append</span>(<span style="color:#c41a16">&#39;circle&#39;</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;r&#39;</span>, <span style="color:#a90d91">this</span>.<span style="color:#000">smallCircleRadius</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;fill&#39;</span>, <span style="color:#000">node</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">color</span>(<span style="color:#000">node</span>.<span style="color:#000">familyType</span>))
    .<span style="color:#000">on</span>(<span style="color:#c41a16">&#39;mouseover&#39;</span>, <span style="color:#000">node</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">mouseover</span>(<span style="color:#000">node</span>))
    .<span style="color:#000">on</span>(<span style="color:#c41a16">&#39;mouseout&#39;</span>, <span style="color:#000">node</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">mouseout</span>())
    .<span style="color:#000">call</span>(<span style="color:#000">d3</span>.<span style="color:#000">drag</span>()
      .<span style="color:#000">on</span>(<span style="color:#c41a16">&#39;start&#39;</span>, <span style="color:#a90d91">this</span>.<span style="color:#000">dragstarted</span>)
      .<span style="color:#000">on</span>(<span style="color:#c41a16">&#39;drag&#39;</span>, <span style="color:#a90d91">this</span>.<span style="color:#000">dragged</span>)
      .<span style="color:#000">on</span>(<span style="color:#c41a16">&#39;end&#39;</span>, <span style="color:#a90d91">this</span>.<span style="color:#000">dragended</span>));

  <span style="color:#a90d91">this</span>.<span style="color:#000">nodeElements</span> <span style="color:#000">=</span> <span style="color:#000">nodeEnter</span>.<span style="color:#000">merge</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">nodeElements</span>);

  <span style="color:#177500">// text labels
</span><span style="color:#177500"></span>  <span style="color:#a90d91">const</span> <span style="color:#000">groups</span> <span style="color:#000">=</span> <span style="color:#000">_</span>.<span style="color:#000">toArray</span>(<span style="color:#000">_</span>.<span style="color:#000">groupBy</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">sensors</span>.<span style="color:#000">slice</span>(), <span style="color:#c41a16">&#39;familyType&#39;</span>));

  <span style="color:#a90d91">this</span>.<span style="color:#000">textElements</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">textGroup</span>.<span style="color:#000">selectAll</span>(<span style="color:#c41a16">&#39;text&#39;</span>)
    .<span style="color:#000">data</span>(<span style="color:#000">groups</span>, <span style="color:#000">group</span> <span style="color:#000">=&gt;</span> <span style="color:#000">group</span>);

  <span style="color:#a90d91">this</span>.<span style="color:#000">textElements</span>.<span style="color:#000">exit</span>().<span style="color:#000">remove</span>();

  <span style="color:#a90d91">const</span> <span style="color:#000">textEnter</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">textElements</span>
    .<span style="color:#000">enter</span>()
    .<span style="color:#000">append</span>(<span style="color:#c41a16">&#39;text&#39;</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;dx&#39;</span>, <span style="color:#1c01ce">15</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;dy&#39;</span>, <span style="color:#1c01ce">4</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;pointer-events&#39;</span>, <span style="color:#c41a16">&#39;none&#39;</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;font-size&#39;</span>, <span style="color:#1c01ce">14</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;text-anchor&#39;</span>, <span style="color:#c41a16">&#39;start&#39;</span>)
    .<span style="color:#000">attr</span>(<span style="color:#c41a16">&#39;fill&#39;</span>, <span style="color:#000">group</span> <span style="color:#000">=&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">color</span>(<span style="color:#000">group</span>[<span style="color:#1c01ce">0</span>].<span style="color:#000">familyType</span>));

  <span style="color:#a90d91">this</span>.<span style="color:#000">textElements</span> <span style="color:#000">=</span> <span style="color:#000">textEnter</span>.<span style="color:#000">merge</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">textElements</span>);
}</code></pre></div>
<p>Here we crunch the data and define the enter, update and exit behaviour for the nodes, the labels and the links.</p>

<h3 id="other-methods">Other methods</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#000">createLinks</span> <span style="color:#000">=</span> () <span style="color:#000">=&gt;</span> {
  <span style="color:#a90d91">const</span> <span style="color:#000">groups</span> <span style="color:#000">=</span> <span style="color:#000">_</span>.<span style="color:#000">groupBy</span>(<span style="color:#a90d91">this</span>.<span style="color:#000">sensors</span>.<span style="color:#000">slice</span>(), <span style="color:#c41a16">&#39;familyType&#39;</span>);

  <span style="color:#a90d91">const</span> <span style="color:#000">computedLinks</span> <span style="color:#000">=</span> [];
  <span style="color:#a90d91">Object</span>.<span style="color:#000">keys</span>(<span style="color:#000">groups</span>).<span style="color:#000">map</span>((<span style="color:#000">key</span>, <span style="color:#000">i</span>) <span style="color:#000">=&gt;</span> {
    <span style="color:#a90d91">const</span> <span style="color:#000">familyTypeSensors</span> <span style="color:#000">=</span> <span style="color:#000">groups</span>[<span style="color:#000">key</span>].<span style="color:#000">sort</span>();
    <span style="color:#a90d91">for</span> (<span style="color:#a90d91">let</span> <span style="color:#000">j</span> <span style="color:#000">=</span> <span style="color:#1c01ce">0</span>; <span style="color:#000">j</span> <span style="color:#000">&lt;</span> <span style="color:#000">familyTypeSensors</span>.<span style="color:#000">length</span>; <span style="color:#000">j</span><span style="color:#000">++</span>) {
      <span style="color:#a90d91">if</span> (<span style="color:#000">j</span> <span style="color:#000">&gt;</span> <span style="color:#1c01ce">0</span>) <span style="color:#000">computedLinks</span>.<span style="color:#000">push</span>({
        <span style="color:#000">source</span>: <span style="color:#a90d91">familyTypeSensors</span>[<span style="color:#000">j</span>],
        <span style="color:#000">target</span>: <span style="color:#a90d91">familyTypeSensors</span>[<span style="color:#000">j</span> <span style="color:#000">-</span> <span style="color:#1c01ce">1</span>]
      });
    }
  });

  <span style="color:#a90d91">return</span> <span style="color:#000">computedLinks</span>;
}

<span style="color:#000">dragstarted</span> <span style="color:#000">=</span> (<span style="color:#000">d</span>) <span style="color:#000">=&gt;</span> {
  <span style="color:#a90d91">if</span> (<span style="color:#000">!</span><span style="color:#000">d3</span>.<span style="color:#000">event</span>.<span style="color:#000">active</span>) <span style="color:#a90d91">this</span>.<span style="color:#000">simulation</span>.<span style="color:#000">alphaTarget</span>(<span style="color:#1c01ce">0.3</span>).<span style="color:#000">restart</span>();
  <span style="color:#000">d</span>.<span style="color:#000">fx</span> <span style="color:#000">=</span> <span style="color:#000">d</span>.<span style="color:#000">x</span>;
  <span style="color:#000">d</span>.<span style="color:#000">fy</span> <span style="color:#000">=</span> <span style="color:#000">d</span>.<span style="color:#000">y</span>;
}

<span style="color:#000">dragged</span> <span style="color:#000">=</span> (<span style="color:#000">d</span>) <span style="color:#000">=&gt;</span> {
  <span style="color:#000">d</span>.<span style="color:#000">fx</span> <span style="color:#000">=</span> <span style="color:#000">d3</span>.<span style="color:#000">event</span>.<span style="color:#000">x</span>;
  <span style="color:#000">d</span>.<span style="color:#000">fy</span> <span style="color:#000">=</span> <span style="color:#000">d3</span>.<span style="color:#000">event</span>.<span style="color:#000">y</span>;
}

<span style="color:#000">dragended</span> <span style="color:#000">=</span> (<span style="color:#000">d</span>) <span style="color:#000">=&gt;</span> {
  <span style="color:#a90d91">if</span> (<span style="color:#000">!</span><span style="color:#000">d3</span>.<span style="color:#000">event</span>.<span style="color:#000">active</span>) <span style="color:#a90d91">this</span>.<span style="color:#000">simulation</span>.<span style="color:#000">alphaTarget</span>(<span style="color:#1c01ce">0</span>);
  <span style="color:#000">d</span>.<span style="color:#000">fx</span> <span style="color:#000">=</span> <span style="color:#a90d91">null</span>;
  <span style="color:#000">d</span>.<span style="color:#000">fy</span> <span style="color:#000">=</span> <span style="color:#a90d91">null</span>;
}

<span style="color:#000">mouseover</span> <span style="color:#000">=</span> (<span style="color:#000">node</span>) <span style="color:#000">=&gt;</span> {
  <span style="color:#177500">// placement
</span><span style="color:#177500"></span>  <span style="color:#a90d91">this</span>.<span style="color:#000">tooltip</span>.<span style="color:#000">style</span>.<span style="color:#000">visibility</span> <span style="color:#000">=</span> <span style="color:#c41a16">&#39;visible&#39;</span>;
  <span style="color:#a90d91">this</span>.<span style="color:#000">tooltip</span>.<span style="color:#000">style</span>.<span style="color:#000">opacity</span> <span style="color:#000">=</span> <span style="color:#1c01ce">0.9</span>;
  <span style="color:#a90d91">this</span>.<span style="color:#000">tooltip</span>.<span style="color:#000">style</span>.<span style="color:#000">top</span> <span style="color:#000">=</span> <span style="color:#000">d3</span>.<span style="color:#000">event</span>.<span style="color:#000">pageY</span> <span style="color:#000">+</span> <span style="color:#c41a16">&#39;px&#39;</span>;
  <span style="color:#a90d91">this</span>.<span style="color:#000">tooltip</span>.<span style="color:#000">style</span>.<span style="color:#000">left</span> <span style="color:#000">=</span> <span style="color:#000">d3</span>.<span style="color:#000">event</span>.<span style="color:#000">pageX</span> <span style="color:#000">+</span> <span style="color:#c41a16">&#39;px&#39;</span>;

  <span style="color:#177500">// Values
</span><span style="color:#177500"></span>  <span style="color:#a90d91">this</span>.<span style="color:#000">node</span> <span style="color:#000">=</span> <span style="color:#000">node</span>;
  <span style="color:#a90d91">this</span>.<span style="color:#000">status</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">findStatus</span>(<span style="color:#000">node</span>);
}

<span style="color:#000">findStatus</span> <span style="color:#000">=</span> (<span style="color:#000">node</span>)<span style="color:#000">:</span> <span style="color:#a90d91">string</span> <span style="color:#000">=&gt;</span> {
  <span style="color:#a90d91">let</span> <span style="color:#000">status</span> <span style="color:#000">=</span> <span style="color:#c41a16">&#39;&#39;</span>;
  <span style="color:#a90d91">if</span> (<span style="color:#000">!</span><span style="color:#000">node</span>.<span style="color:#000">activated</span>) <span style="color:#000">status</span> <span style="color:#000">=</span> <span style="color:#c41a16">&#39;Not activated&#39;</span>;
  <span style="color:#a90d91">if</span> (<span style="color:#000">node</span>.<span style="color:#000">activated</span> <span style="color:#000">&amp;&amp;</span> <span style="color:#000">node</span>.<span style="color:#000">online</span>)  <span style="color:#000">status</span> <span style="color:#000">=</span> <span style="color:#c41a16">&#39;Online&#39;</span>;
  <span style="color:#a90d91">if</span> (<span style="color:#000">node</span>.<span style="color:#000">activated</span> <span style="color:#000">&amp;&amp;</span> <span style="color:#000">!</span><span style="color:#000">node</span>.<span style="color:#000">online</span>) <span style="color:#000">status</span> <span style="color:#000">=</span> <span style="color:#c41a16">&#39;Offline&#39;</span>;
  <span style="color:#a90d91">return</span> <span style="color:#000">status</span>;
}

<span style="color:#000">mouseout</span> <span style="color:#000">=</span> () <span style="color:#000">=&gt;</span> {
  <span style="color:#a90d91">this</span>.<span style="color:#000">tooltip</span>.<span style="color:#000">style</span>.<span style="color:#000">visibility</span> <span style="color:#000">=</span> <span style="color:#c41a16">&#39;hidden&#39;</span>;
  <span style="color:#a90d91">this</span>.<span style="color:#000">tooltip</span>.<span style="color:#000">style</span>.<span style="color:#000">opacity</span> <span style="color:#000">=</span> <span style="color:#1c01ce">0</span>;
}

<span style="color:#000">placeElementY</span> <span style="color:#000">=</span> (<span style="color:#000">node</span>)<span style="color:#000">:</span> <span style="color:#a90d91">number</span> <span style="color:#000">=&gt;</span> {
  <span style="color:#a90d91">const</span> <span style="color:#000">radius</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">smallCircleRadius</span>;

  <span style="color:#a90d91">if</span> (<span style="color:#000">node</span>.<span style="color:#000">y</span> <span style="color:#000">&lt;</span> <span style="color:#000">radius</span>) <span style="color:#a90d91">return</span> <span style="color:#000">radius</span>;
  <span style="color:#a90d91">if</span> (<span style="color:#000">node</span>.<span style="color:#000">y</span> <span style="color:#000">&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">height</span> <span style="color:#000">-</span> <span style="color:#000">radius</span>) <span style="color:#a90d91">return</span> <span style="color:#a90d91">this</span>.<span style="color:#000">height</span> <span style="color:#000">-</span> <span style="color:#000">radius</span>;
  <span style="color:#a90d91">return</span> <span style="color:#000">node</span>.<span style="color:#000">y</span>;
}

<span style="color:#000">placeElementX</span> <span style="color:#000">=</span> (<span style="color:#000">node</span>)<span style="color:#000">:</span> <span style="color:#a90d91">number</span> <span style="color:#000">=&gt;</span> {
  <span style="color:#a90d91">const</span> <span style="color:#000">radius</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#000">smallCircleRadius</span>;

  <span style="color:#a90d91">if</span> (<span style="color:#000">node</span>.<span style="color:#000">x</span> <span style="color:#000">&lt;</span> <span style="color:#000">radius</span>) <span style="color:#a90d91">return</span> <span style="color:#000">radius</span>;
  <span style="color:#a90d91">if</span> (<span style="color:#000">node</span>.<span style="color:#000">x</span> <span style="color:#000">&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#000">width</span> <span style="color:#000">-</span> <span style="color:#000">radius</span>) <span style="color:#a90d91">return</span> <span style="color:#a90d91">this</span>.<span style="color:#000">width</span> <span style="color:#000">-</span> <span style="color:#000">radius</span>;
  <span style="color:#a90d91">return</span> <span style="color:#000">node</span>.<span style="color:#000">x</span>;
}</code></pre></div>
<h3 id="data-service">Data service</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#a90d91">import</span> { <span style="color:#000">Injectable</span>, <span style="color:#000">OnInit</span> } <span style="color:#000">from</span> <span style="color:#c41a16">&#39;@angular/core&#39;</span>;

<span style="color:#a90d91">@Injectable</span>()
<span style="color:#a90d91">export</span> <span style="color:#a90d91">class</span> <span style="color:#000">ForceDirectedDataService</span> {
  <span style="color:#000">sensors</span> <span style="color:#000">=</span> [];
  <span style="color:#000">families</span> <span style="color:#000">=</span> [<span style="color:#c41a16">&#39;Temperature&#39;</span>, <span style="color:#c41a16">&#39;Luminosity&#39;</span>, <span style="color:#c41a16">&#39;Noise&#39;</span>, <span style="color:#c41a16">&#39;Humidity&#39;</span>, <span style="color:#c41a16">&#39;Dust&#39;</span>];
  <span style="color:#000">maxSensors</span> <span style="color:#000">=</span> <span style="color:#1c01ce">30</span>;

  <span style="color:#000">createSensors</span> <span style="color:#000">=</span> (<span style="color:#000">num</span>: <span style="color:#a90d91">number</span>) <span style="color:#000">=&gt;</span> {
    <span style="color:#a90d91">const</span> <span style="color:#000">max</span> <span style="color:#000">=</span> <span style="color:#a90d91">Math</span>.<span style="color:#000">floor</span>(<span style="color:#a90d91">Math</span>.<span style="color:#000">random</span>() <span style="color:#000">*</span> <span style="color:#000">num</span>);
    <span style="color:#177500">// create sensors
</span><span style="color:#177500"></span>    <span style="color:#a90d91">const</span> <span style="color:#000">results</span> <span style="color:#000">=</span> [];
    <span style="color:#a90d91">for</span> (<span style="color:#a90d91">let</span> <span style="color:#000">i</span> <span style="color:#000">=</span> <span style="color:#1c01ce">0</span>; <span style="color:#000">i</span> <span style="color:#000">&lt;</span> <span style="color:#000">max</span>; <span style="color:#000">i</span><span style="color:#000">++</span>) {
      <span style="color:#a90d91">const</span> <span style="color:#000">result</span> <span style="color:#000">=</span> {
        <span style="color:#000">id</span>: <span style="color:#a90d91">i</span>,
        <span style="color:#000">familyType</span>: <span style="color:#a90d91">this.families</span>[<span style="color:#a90d91">Math</span>.<span style="color:#000">floor</span>(<span style="color:#a90d91">Math</span>.<span style="color:#000">random</span>() <span style="color:#000">*</span> <span style="color:#a90d91">this</span>.<span style="color:#000">families</span>.<span style="color:#000">length</span>)],
        <span style="color:#000">address</span><span style="color:#000">:</span> <span style="color:#c41a16">&#39;192.168.0.1&#39;</span>,
        <span style="color:#000">name</span><span style="color:#000">:</span> <span style="color:#c41a16">&#39;MAN1-PMC-Temperature-Sensor-01&#39;</span>,
        <span style="color:#000">vendor</span><span style="color:#000">:</span> <span style="color:#c41a16">&#39;Veris&#39;</span>,
        <span style="color:#000">model</span><span style="color:#000">:</span> <span style="color:#c41a16">&#39;TED00&#39;</span>,
        <span style="color:#000">protocol</span><span style="color:#000">:</span> <span style="color:#c41a16">&#39;3-Wire&#39;</span>
      };
      <span style="color:#000">results</span>.<span style="color:#000">push</span>(<span style="color:#000">result</span>);
    }
    <span style="color:#a90d91">return</span> <span style="color:#000">results</span>;
  }
}</code></pre></div>
<h3 id="styling">Styling</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scss" data-lang="scss"><span style="color:#3f6e75">.force-directed-chart</span> {
  <span style="color:#000">width</span><span style="color:#000">:</span> <span style="color:#000">100</span><span style="color:#000">%</span><span style="color:#000">;</span>
  <span style="color:#000">height</span><span style="color:#000">:</span> <span style="color:#000">400px</span> <span style="color:#000">!</span><span style="color:#000">important</span><span style="color:#000">;</span>
}

<span style="color:#3f6e75">.tooltip</span>{
  <span style="color:#000">position</span><span style="color:#000">:</span> <span style="color:#000">absolute</span><span style="color:#000">;</span>
  <span style="color:#000">background</span><span style="color:#000">:</span> <span style="color:#000">#f5f6f5</span><span style="color:#000">;</span>
  <span style="color:#000">box-shadow</span><span style="color:#000">:</span> <span style="color:#000">0</span> <span style="color:#000">1px</span> <span style="color:#000">3px</span> <span style="color:#000">rgba</span><span style="color:#000">(</span><span style="color:#000">0</span><span style="color:#000">,</span><span style="color:#000">0</span><span style="color:#000">,</span><span style="color:#000">0</span><span style="color:#000">,</span><span style="color:#000">0</span><span style="color:#3f6e75">.12</span><span style="color:#000">),</span> <span style="color:#000">0</span> <span style="color:#000">1px</span> <span style="color:#000">2px</span> <span style="color:#000">rgba</span><span style="color:#000">(</span><span style="color:#000">0</span><span style="color:#000">,</span><span style="color:#000">0</span><span style="color:#000">,</span><span style="color:#000">0</span><span style="color:#000">,</span><span style="color:#000">0</span><span style="color:#3f6e75">.24</span><span style="color:#000">);</span>

  <span style="color:#000">opacity</span><span style="color:#000">:</span> <span style="color:#000">0</span><span style="color:#000">;</span>
  <span style="color:#000">transition</span><span style="color:#000">:</span> <span style="color:#000">visibility</span> <span style="color:#000">0s</span><span style="color:#000">,</span> <span style="color:#000">opacity</span> <span style="color:#000">0</span><span style="color:#3f6e75">.5s</span> <span style="color:#000">linear</span><span style="color:#000">;</span>
  <span style="color:#000">visibility</span><span style="color:#000">:</span> <span style="color:#000">hidden</span><span style="color:#000">;</span>
  <span style="color:#000">pointer-events</span><span style="color:#000">:</span> <span style="color:#000">none</span><span style="color:#000">;</span>

  <span style="color:#3f6e75">.header</span>{
    <span style="color:#000">color</span><span style="color:#000">:</span> <span style="color:#000">$</span><span style="color:#000">primary</span><span style="color:#000">;</span>
    <span style="color:#000">padding</span><span style="color:#000">:</span> <span style="color:#000">20px</span><span style="color:#000">;</span>
    <span style="color:#000">border-bottom</span><span style="color:#000">:</span> <span style="color:#000">1px</span> <span style="color:#000">solid</span> <span style="color:#000">$</span><span style="color:#000">border-color</span><span style="color:#000">;</span>
    <span style="color:#3f6e75">.title</span>{
      <span style="color:#000">font-weight</span><span style="color:#000">:</span> <span style="color:#000">bold</span><span style="color:#000">;</span>
      <span style="color:#000">font-size</span><span style="color:#000">:</span> <span style="color:#000">1</span><span style="color:#3f6e75">.2em</span><span style="color:#000">;</span>
    }

    <span style="color:#000">img</span>{
      <span style="color:#000">margin-right</span><span style="color:#000">:</span> <span style="color:#000">20px</span><span style="color:#000">;</span>
    }
  }

  <span style="color:#3f6e75">.body</span>{
    <span style="color:#3f6e75">.subtitle</span>{
      <span style="color:#000">font-weight</span><span style="color:#000">:</span> <span style="color:#000">bold</span><span style="color:#000">;</span>
      <span style="color:#000">color</span><span style="color:#000">:</span> <span style="color:#000">$</span><span style="color:#000">primary</span><span style="color:#000">;</span>
      <span style="color:#000">filter</span><span style="color:#000">:</span> <span style="color:#000">brightness</span><span style="color:#000">(</span><span style="color:#000">90</span><span style="color:#000">%</span><span style="color:#000">);</span>
    }
    <span style="color:#000">padding</span><span style="color:#000">:</span> <span style="color:#000">20px</span><span style="color:#000">;</span>
  }
}</code></pre></div>
<p>Happy plotting! Have a look at the source code here: <a href="https://github.com/HoplaGeiss/hopla-force-directed-chart">https://github.com/HoplaGeiss/hopla-force-directed-chart</a></p>

  			</section>

  			<footer class="post-footer">
  				<div class="post-tags">
            
            
                <a href="http://www.muller.tech/tags/angular5/">angular5</a>
            
                <a href="http://www.muller.tech/tags/d3.js/">d3.js</a>
            
            
  				</div>
  				
  			</footer>

  			<aside class="post-comments">
    
    
    <div id="disqus_thread"></div>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
    
</aside>


			</div>

			<nav class="post-nav">
				
					<a class="post-nav-item post-nav-next" href="http://www.muller.tech/post/2017/11/20/angular5-d3js-bubble-chart/">
						<section class="post-nav-teaser">
							<span class="post-nav-icon"><i class="icon-arrow-left"></i></span>
							<span class="post-nav-info">
								<h4 class="post-nav-title">Angular 5 / d3.js - Bubble Chart</h4>
								<p class="post-nav-excerpt">Create a dynamic and resizable bubble chart with angular5 and d3.js&hellip;</p>
							</span>
						</section>
					</a>
				
				
					<a class="post-nav-item post-nav-prev" href="http://www.muller.tech/post/2017/11/20/angular5-d3js-scatter-chart/">
						<section class="post-nav-teaser">
							<span class="post-nav-icon"><i class="icon-arrow-right"></i></span>
							<span class="post-nav-info">
								<h4 class="post-nav-title">Angular 5 / d3.js - Scatter Chart</h4>
								<p class="post-nav-excerpt">Create a scatter chart with angular5 and d3.js&hellip;</p>
							</span>
						</section>
					</a>
				
				<div class="clear"></div>
			</nav>

		</div>
	</article>
</main>

<div id="body-class" style="display: none;"></div>
<footer id="footer">
	<section class="credits">
		
	</section>

	<div id="sig" style="position: absolute; font-family: Helvetica, Verdana, Arial, Sans-Serif; font-size: 12px; color: #999999; bottom: 0; left: calc(50% - 145px);">
	  <div style="position: relative; display: inline-block;">
	    <span style="line-height: 30px;">
	      <div style="display: inline-block; float: left;">
	        <span style="font-weight: bold;">Gabriel Muller</span> - Full Stack Developer |
	      </div>

	      <a target="_blank" href="https://uk.linkedin.com/in/mullergab" style="position: relative;display: inline-block; text-decoration:none; float: left">
	        <img src="http://www.muller.tech/images/linkedin.png" alt="linkedin" style="width: 20px; padding: 5px 10px; margin:0" />
	      </a>
	      <span style="float: left"> | </span>
	      <a target="_blank" href="https://github.com/hoplageiss" style="position: relative;display: inline-block; text-decoration:none; float: left">
	        <img src="http://www.muller.tech/images/github.png" alt="github" style="width: 20px; padding: 5px 10px; margin:0"/>
	      </a>
	    </span>
	  </div>
	</div>
</footer>


<div id="tocMenu" data-target="toc">
    <div class="menu-header">
        <span class="menu-label">Menu</span>
        <a class="menu-close" data-action="toc" data-target="toc"></a>
    </div>
    <div id="toc" class="menu-list">
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#component-skeleton">Component skeleton</a></li>
<li><a href="#life-cycle-methods">Life cycle methods</a></li>
<li><a href="#create-the-chart">Create the chart</a></li>
<li><a href="#run-the-simulation">Run the simulation</a></li>
<li><a href="#render">Render</a></li>
<li><a href="#other-methods">Other methods</a></li>
<li><a href="#data-service">Data service</a></li>
<li><a href="#styling">Styling</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>


<div class="overlay"></div>
</div>
</section>

<script async src="/js/main.js"></script>



<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-69583716-1', 'auto');
ga('send', 'pageview');
</script>




<noscript><link rel="stylesheet" href="/css/main.css"></noscript>
</body>
</html>

